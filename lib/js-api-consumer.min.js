/*! js-api-consumer 2014-01-07 */
!function(a){a.fn.extend({formSearch:function(b){return b=b||{},"destroy"===b?this.each(function(){a(this).select2("destroy")}):this.each(function(){var c;c="https://"+(b.staging?"staging.":"")+"api.covermymeds.com/forms?v="+CMM_API_CONFIG.version,a(this).select2({placeholder:"Plan, PBM, Form name, BIN, or Contract ID",minimumInputLength:4,ajax:{quietMillis:250,url:b.url||c,transport:function(c){return b.url||(c.beforeSend=function(a){a.setRequestHeader("Authorization","Basic "+Base64.encode(CMM_API_CONFIG.apiId+":"+CMM_API_CONFIG.apiSecret))}),a.ajax(c)},data:function(c){var d,e;return d=b.state||a('select[name="request[state]"]').val(),e=b.drugId||a('input[name="request[drug_id]"]').val(),{q:c,state:d,drug_id:e}},results:function(a,b){var c,d,e,f=[];for(c=10*b<a.total,d=0,e=a.forms.length;e>d;d+=1)f.push({id:a.forms[d].request_form_id,text:a.forms[d].description,thumbnail_url:a.forms[d].thumbnail_url});return{results:f,more:c}}},formatResult:function(a){var b;return b="<table class='table'>",b+="<tr>",b+="<td><img src='"+a.thumbnail_url+"' /></td>",b+="<td>"+a.text+"</td>",b+="</tr>",b+="</table>"}})})}})}(jQuery),function(a){a.fn.extend({drugSearch:function(b){return b=b||{},"destroy"===b?this.each(function(){a(this).select2("destroy")}):this.each(function(){var c;c="https://"+(b.staging?"staging.":"")+"api.covermymeds.com/drugs?v="+CMM_API_CONFIG.version,a(this).select2({placeholder:"Begin typing the medication name and select from list",minimumInputLength:4,ajax:{quietMillis:250,url:b.url||c,transport:function(c){return b.url||(c.beforeSend=function(a){a.setRequestHeader("Authorization","Basic "+Base64.encode(CMM_API_CONFIG.apiId+":"+CMM_API_CONFIG.apiSecret))}),a.ajax(c)},data:function(a){return{q:a}},results:function(a,b){var c,d,e,f=[];for(c=10*b<a.total,d=0,e=a.drugs.length;e>d;d+=1)f.push({text:a.drugs[d].full_name,id:a.drugs[d].id});return{results:f,more:c}}}})})}})}(jQuery),function(a){a.fn.extend({createRequest:function(b){return b=b||{},"destroy"===b?this.each(function(){a(this).off("click")}):this.each(function(){var c,d,e,f;c="https://"+(b.staging?"staging.":"")+"api.covermymeds.com/requests?v="+CMM_API_CONFIG.version,d=b.url?{}:{Authorization:"Basic "+Base64.encode(CMM_API_CONFIG.apiId+":"+CMM_API_CONFIG.apiSecret)},e=a(this),f=!1,e.on("click",function(g){if(g.preventDefault(),f!==!0){e.attr("disabled","disabled"),f=!0;var h={request:{urgent:a('input[name="request[urgent]"]').attr("checked"),form_id:a('input[name="request[form_id]"]').val(),state:a('select[name="request[state]"]').val(),patient:{first_name:a('input[name="request[patient][first_name]"]').val(),middle_name:a('input[name="request[patient][middle_name]"]').val(),last_name:a('input[name="request[patient][last_name]"]').val(),date_of_birth:a('input[name="request[patient][date_of_birth]"]').val(),gender:a('select[name="request[patient][gender]"]').val(),email:a('input[name="request[patient][email]"]').val(),health_plan_name:a('input[name="request[patient][health_plan_name]"]').val(),member_id:a('input[name="request[patient][member_id]"]').val(),group_id:a('input[name="request[patient][group_id]"]').val(),phone_number:a('input[name="request[patient][phone_number]"]').val(),address:{street_1:a('input[name="request[patient][address][street_1]"]').val(),street_2:a('input[name="request[patient][address][street_2]"]').val(),city:a('input[name="request[patient][address][city]"]').val(),state:a('select[name="request[patient][address][state]"]').val(),zip:a('input[name="request[patient][address][zip]"]').val()}},prescriber:{npi:a('input[name="request[prescriber][npi]"]').val(),first_name:a('input[name="request[prescriber][first_name]"]').val(),last_name:a('input[name="request[prescriber][last_name]"]').val(),clinic_name:a('input[name="request[prescriber][clinic_name]"]').val(),address:{street_1:a('input[name="request[prescriber][address][street_1]"]').val(),street_2:a('input[name="request[prescriber][address][street_2]"]').val(),city:a('input[name="request[prescriber][address][city]"]').val(),state:a('select[name="request[prescriber][address][state]"]').val(),zip:a('input[name="request[prescriber][address][zip]"]').val()},fax_number:a('input[name="request[prescriber][fax_number]"]').val(),phone_number:a('input[name="request[prescriber][phone_number]"]').val()},prescription:{drug_id:a('input[name="request[prescription][drug_id]"]').val(),strength:a('input[name="request[prescription][strength]"]').val(),frequency:a('input[name="request[prescription][frequency]"]').val(),enumerated_fields:a('input[name="request[prescription][enumerated_fields]"]').val(),refills:a('input[name="request[prescription][refills]"]').val(),dispense_as_written:a('input[name="request[prescription][dispense_as_written]"]').val(),quantity:a('input[name="request[prescription][quantity]"]').val(),days_supply:a('input[name="request[prescription][days_supply]"]').val()},pharmacy:{name:a('input[name="request[pharmacy][name]"]').val(),address:{street_1:a('input[name="request[pharmacy][address][street_1]"]').val(),street_2:a('input[name="request[pharmacy][address][street_2]"]').val(),city:a('input[name="request[pharmacy][address][city]"]').val(),state:a('select[name="request[pharmacy][address][state]"]').val(),zip:a('input[name="request[pharmacy][address][zip]"]').val()},fax_number:a('input[name="request[pharmacy][fax_number]"]').val(),phone_number:a('input[name="request[pharmacy][phone_number]"]').val()},enumerated_fields:{icd9_0:a('input[name="request[enumerated_fields][icd9_0]"]').val(),icd9_1:a('input[name="request[enumerated_fields][icd9_1]"]').val(),icd9_2:a('input[name="request[enumerated_fields][icd9_2]"]').val(),failed_med_0:a('input[name="request[enumerated_fields][failed_med_0]"]').val(),failed_med_1:a('input[name="request[enumerated_fields][failed_med_1]"]').val(),failed_med_2:a('input[name="request[enumerated_fields][failed_med_2]"]').val(),failed_med_3:a('input[name="request[enumerated_fields][failed_med_3]"]').val(),failed_med_4:a('input[name="request[enumerated_fields][failed_med_4]"]').val(),failed_med_5:a('input[name="request[enumerated_fields][failed_med_5]"]').val(),failed_med_6:a('input[name="request[enumerated_fields][failed_med_6]"]').val(),failed_med_7:a('input[name="request[enumerated_fields][failed_med_7]"]').val(),failed_med_8:a('input[name="request[enumerated_fields][failed_med_8]"]').val(),failed_med_9:a('input[name="request[enumerated_fields][failed_med_9]"]').val()}}};a.ajax({url:b.url||c,type:"POST",headers:d,success:function(a,c,d){e.removeAttr("disabled"),f=!1,"function"==typeof b.success&&b.success(a,c,d)},error:function(a,c,d){e.removeAttr("disabled"),f=!1,"function"==typeof b.error&&b.error(a,c,d)},data:b.data||h})}})})}})}(jQuery),function(a){a.fn.extend({dashboard:function(b){return b=b||{},this.each(function(){function c(b){var d,e;b.preventDefault(),h=parseInt(a(b.target).attr("href"),10),d=h*j,e=d+j,a(l).empty().append(g({requests:f.slice(d,e),currentPage:h,totalPages:i})),a(".pagination a").on("click",c)}function d(b){f=b.requests,i=Math.ceil(f.length/j),a(l).empty().append(g({requests:f.slice(0,j),currentPage:h,totalPages:i})),a(".pagination a").on("click",c)}var e,f,g,h,i,j,k,l;h=0,j=10,l=this,e="https://"+(b.staging?"staging.":"")+"api.covermymeds.com/requests/search?v="+CMM_API_CONFIG.version,k=b.url?{}:{Authorization:"Basic "+Base64.encode(CMM_API_CONFIG.apiId+":"+CMM_API_CONFIG.apiSecret)},a(this).html("<h1>Loading...</h1>"),g=_.template('<% _.each(requests, function (request) { %><div class="request row"><div class="col-lg-2"><img src="<%= request.thumbnail_urls %>" /></div><div class="col-lg-4"><ul><li><h4><%= request.patient.first_name %> <%= request.patient.last_name %> (Key: <%= request.id %>)</h4></li><li><strong>Status:</strong> <span class="label label-info"><%= request.workflow_status %></span><li>Drug Name Here</li><li><strong>Created:</strong> <%= request.created_at %></li><li><a href="<%= request.tokens[0].html_url %>">View</a></li></ul></div></div><% }); %><% if (totalPages > 1) { %><ul class="pagination"><% for (var i = 0; i < totalPages; i += 1) { %><li class="<%= (i === currentPage) ? "active" : "" %>"><a href="<%= i %>"><%= (i + 1) %></a></li><% } %></ul><% } %>'),void 0!==b.data?d(b.data):a.ajax({url:b.url||e,type:"POST",headers:k,data:{ids:b.ids},success:d,error:function(){a(l).empty().text("There was an error processing your request. Please try again.")}})})}})}(jQuery),function(a){a.fn.extend({showHelp:function(b){return b=a.extend({},b),this.each(function(){var b='<h1>For assistance using CoverMyMeds&reg;</h1><ul><li>Phone: 1-866-452-5017</li><li>Email: <a href="mailto:help@covermymeds.com">help@covermymeds.com</a></li></ul><h1>Send forms or report data issues</h1><ul><li>Phone: 1-866-452-5017</li><li>Fax: 1-615-379-2541</li><li>Email: <a href="mailto:data@covermymeds.com">data@covermymeds.com</a></li>';a(this).html(b)})}})}(jQuery);var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=Base64._utf8_encode(a);j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h);return i},decode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=this._keyStr.indexOf(a.charAt(j++)),f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=Base64._utf8_decode(i)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}};